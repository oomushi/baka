// https://github.com/sadjehwty/jquery.multiUpload.js
// compressed with http://www.minifyjavascript.com/
(function($){$.fn.multiUpload=function(customOptions){var options={max:0,name_suffix_template:'_{id}',show_filename_only:false,remove_empty_element:true,container_tag:'div',list_tag:'ul',element_tag:'li',container_class:'mfu_container',list_class:'mfu_list',element_class:'mfu_element',remove_label:'remove',remove_img:'/mfu_remove.png',remove_class:'mfu_remove',max_overflow:function(){alert('You may not upload more than '+options.max+' files')},remove_confirm:function(element){return confirm('Are you sure you want to remove the item\r\n'+element.parent().children('.mfu_name').text()+'\r\nfrom the upload queue?')},remove:function(el,src){},add:function(el,src){},id_gen:function(el){return el.closest().children('.'+options.list_class).length}};$.extend(options,customOptions);return this.each(function(index){if(!($(this).attr('type')=='file'&&$(this).prop("tagName")=='INPUT'))return;var $original=$(this);var $container=$('<'+options.container_tag+'>').addClass(options.container_class);var $list=$('<'+options.list_tag+'>').addClass(options.list_class);var name=$(this).attr('name');function init(element,change){if(change)element.change(function(){if(options.max>0&&$list.children().length>options.max)options.max_overflow();var name=$(this).val();if(options.show_filename_only){if(name.indexOf('\\')>=0){name=name.substring(name.lastIndexOf('\\')+1)}if(name.indexOf('//')>=0){name=name.substring(name.lastIndexOf('//')+1)}}var $name=$('<span>').addClass("mfu_name").text(name);var $line=$('<'+options.element_tag+'>').addClass(options.element_class);var $rm;if(options.remove_img)$rm=$('<img>').attr('src',options.remove_img).attr('alt',options.remove_label);else $rm=$('<span>').text(options.remove_label);$rm.attr('title',options.remove_label).addClass(options.remove_class).click(function(){var $line=$(this).closest(options.element_tag);var $element=$line.find(':input[type="file"]').first();options.remove($(this),$element);if(options.remove_confirm($element)){$element.closest('.mfu_container').children(':input[type="file"]').removeAttr('disabled');$line.remove()}});$line.append($name);$line.append($(this));$line.append($rm);$list.append($line);var $new=$(this).clone(true).val('');init($new);if(options.max==$list.children().length)$new.attr('disabled','disabled');$(this).css({position:'absolute',left:'-1000px',display:'none'});$list.before($new);options.add($line,$(this))});element.attr('name',name+options.name_suffix_template.replace(/\{id\}/,options.name_gen(element)))}init($original,true);$original.after($container);$container.append($original);$container.append($list);if(options.remove_empty_element){$original.closest('form').submit(function(){$(this).find(':input').last().attr('disabled','disabled')})}})}})(jQuery);
